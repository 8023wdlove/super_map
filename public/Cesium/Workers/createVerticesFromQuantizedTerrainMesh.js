import{a as Cr,b as Lr}from"./chunk-3EGULWTI.js";import{a as $}from"./chunk-EAHMNWOP.js";import{a as Vr}from"./chunk-K6FM2O3N.js";import{a as yr}from"./chunk-MBZVWSMC.js";import"./chunk-5IORCEOD.js";import"./chunk-IMPZ7UGB.js";import"./chunk-ZJ45HMNY.js";import{a as Yr}from"./chunk-LKTE2YWL.js";import"./chunk-RELHBJJP.js";import"./chunk-VETUMSV6.js";import{a as J}from"./chunk-MJVT7BN7.js";import"./chunk-OGTTQ4KL.js";import"./chunk-7AR5UXG3.js";import{a as ar}from"./chunk-XKBSMKNP.js";import{d as kr,m as tr}from"./chunk-K2IDXOCV.js";import"./chunk-NPAFDOYL.js";import{b as x}from"./chunk-45OWWDV7.js";import"./chunk-JX5O4HI2.js";import"./chunk-6S43R6PL.js";import"./chunk-TW5GUTQO.js";import"./chunk-ZRLECQ27.js";import{a as gr}from"./chunk-FEOWMVRK.js";import{a as Gr,b as Hr}from"./chunk-CUQT2UK5.js";import"./chunk-CB3KB2D3.js";import{a as A,c as Pr}from"./chunk-I46SWINN.js";import{a as h}from"./chunk-LNIYJJXS.js";import"./chunk-4D2ERGZX.js";import"./chunk-EDZQSM3T.js";import{a as m}from"./chunk-PJGSCWXZ.js";import{a as T}from"./chunk-NUC3LT2W.js";import"./chunk-SFC4FDPW.js";function g(){m.throwInstantiationError()}Object.defineProperties(g.prototype,{errorEvent:{get:m.throwInstantiationError},credit:{get:m.throwInstantiationError},tilingScheme:{get:m.throwInstantiationError},ready:{get:m.throwInstantiationError},readyPromise:{get:m.throwInstantiationError},hasWaterMask:{get:m.throwInstantiationError},hasVertexNormals:{get:m.throwInstantiationError},availability:{get:m.throwInstantiationError}});var er=[];g.getRegularGridIndices=function(r,a){if(r*a>=h.FOUR_GIGABYTES)throw new m("The total number of vertices (width * height) must be less than 4,294,967,296.");var t=er[r];T(t)||(er[r]=t=[]);var o=t[a];return T(o)||(r*a<h.SIXTY_FOUR_KILOBYTES?o=t[a]=new Uint16Array((r-1)*(a-1)*6+3*(r+a-2)):o=t[a]=new Uint32Array((r-1)*(a-1)*6+3*(r+a-2)),Er(r,a,o,0)),o};g.getRegularGridIndicesForReproject=function(r,a){if(r*a>=h.FOUR_GIGABYTES)throw new m("The total number of vertices (width * height) must be less than 4,294,967,296.");var t=er[r];T(t)||(er[r]=t=[]);var o=t[a];return T(o)||(r*a<h.SIXTY_FOUR_KILOBYTES?o=t[a]=new Uint16Array((r-1)*(a-1)*6):o=t[a]=new Uint32Array((r-1)*(a-1)*6),Er(r,a,o,0)),o};var Rr=[];g.getRegularGridIndicesAndEdgeIndices=function(r,a){if(r*a>=h.FOUR_GIGABYTES)throw new m("The total number of vertices (width * height) must be less than 4,294,967,296.");var t=Rr[r];T(t)||(Rr[r]=t=[]);var o=t[a];if(!T(o)){var n=g.getRegularGridIndices(r,a),u=zr(r,a),e=u.westIndicesSouthToNorth,i=u.southIndicesEastToWest,v=u.eastIndicesNorthToSouth,s=u.northIndicesWestToEast;o=t[a]={indices:n,westIndicesSouthToNorth:e,southIndicesEastToWest:i,eastIndicesNorthToSouth:v,northIndicesWestToEast:s}}return o};var Ur=[];g.getRegularGridAndSkirtIndicesAndEdgeIndices=function(r,a){if(r*a>=h.FOUR_GIGABYTES)throw new m("The total number of vertices (width * height) must be less than 4,294,967,296.");var t=Ur[r];T(t)||(Ur[r]=t=[]);var o=t[a];if(!T(o)){var n=r*a,u=(r-1)*(a-1)*6,e=r*2+a*2,i=Math.max(0,e-4)*6,v=n+e,s=3*(r+a-2),M=u+i+s,E=zr(r,a),d=E.westIndicesSouthToNorth,l=E.southIndicesEastToWest,S=E.eastIndicesNorthToSouth,N=E.northIndicesWestToEast,w=ar.createTypedArray(v,M);Er(r,a,w,0),g.addSkirtIndices(d,l,S,N,n,w,u+s),o=t[a]={indices:w,westIndicesSouthToNorth:d,southIndicesEastToWest:l,eastIndicesNorthToSouth:S,northIndicesWestToEast:N,indexCountWithoutSkirts:u}}return o};g.addSkirtIndices=function(r,a,t,o,n,u,e,i){var v=n;e=or(r,v,u,e,i),v+=r.length,e=or(a,v,u,e,i),v+=a.length,e=or(t,v,u,e,i),v+=t.length,or(o,v,u,e,i)};function zr(r,a){var t=new Array(a),o=new Array(r),n=new Array(a),u=new Array(r),e;for(e=0;e<r;++e)u[e]=e,o[e]=r*a-1-e;for(e=0;e<a;++e)n[e]=(e+1)*r-1,t[e]=(a-e-1)*r;return{westIndicesSouthToNorth:t,southIndicesEastToWest:o,eastIndicesNorthToSouth:n,northIndicesWestToEast:u}}function Er(r,a,t,o){for(var n=0,u=0;u<a-1;++u){for(var e=0;e<r-1;++e){var i=n,v=i+r,s=v+1,M=i+1;t[o++]=i,t[o++]=v,t[o++]=M,t[o++]=M,t[o++]=v,t[o++]=s,++n}++n}var E=(a-1)/2,d=(r-1)/2;n=0;for(var e=0;e<d;e++)t[o++]=n,t[o++]=n+1,t[o++]=n+2,n+=2;n=r*(a-1);for(var e=0;e<d;e++)t[o++]=n+1,t[o++]=n,t[o++]=n+2,n+=2;n=0;for(var e=0;e<E;e++)t[o++]=n+r,t[o++]=n,t[o++]=n+2*r,n+=2*r;n=r-1;for(var e=0;e<E;e++)t[o++]=n,t[o++]=n+r,t[o++]=n+2*r,n+=2*r}function or(r,a,t,o,n){for(var u=T(n),e=r[0],i=r.length,v=1;v<i;++v){var s=r[v];if(u&&!n[e+"_"+s]){e=s,++a;continue}t[o++]=e,t[o++]=s,t[o++]=a,t[o++]=a,t[o++]=s,t[o++]=a+1,e=s,++a}return o}g.heightmapTerrainQuality=.25;g.getEstimatedLevelZeroGeometricErrorForAHeightmap=function(r,a,t){return r.maximumRadius*2*Math.PI*g.heightmapTerrainQuality/(a*t)};g.prototype.requestTileGeometry=m.throwInstantiationError;g.prototype.getLevelMaximumGeometricError=m.throwInstantiationError;g.prototype.getTileDataAvailable=m.throwInstantiationError;g.prototype.loadTileDataAvailability=m.throwInstantiationError;var Br=g;var y=32767,Q=new A,lt=new A,It=new A,I=new Pr,b=new gr,Dr=new A,qr=new x,Qr=new x;function mt(r,a){var t=r.quantizedVertices,o=t.length/3,n=r.octEncodedNormals,u=r.westIndices.length+r.eastIndices.length+r.southIndices.length+r.northIndices.length,e=r.includeWebMercatorT,i=Hr.clone(r.rectangle),v=i.west,s=i.south,M=i.east,E=i.north,d=Gr.clone(r.ellipsoid),l=r.exaggeration,S=r.minimumHeight*l,N=r.maximumHeight*l,w=T(r.validMinimumHeight)?r.validMinimumHeight*l:S*l,K=T(r.validMaximumHeight)?r.validMaximumHeight*l:N*l,p=r.relativeToCenter,F=tr.eastNorthUpToFixedFrame(p,d),Y=x.inverseTransformation(F,new x),O,W;e&&(O=$.geodeticLatitudeToMercatorAngle(s),W=1/($.geodeticLatitudeToMercatorAngle(E)-O));var j=t.subarray(0,o),q=t.subarray(o,2*o),sr=t.subarray(o*2,3*o),X=T(n),c=new Array(o),f=new Array(o),C=new Array(o),Z=e?new Array(o):[],_=lt;_.x=Number.POSITIVE_INFINITY,_.y=Number.POSITIVE_INFINITY,_.z=Number.POSITIVE_INFINITY;var P=It;P.x=Number.NEGATIVE_INFINITY,P.y=Number.NEGATIVE_INFINITY,P.z=Number.NEGATIVE_INFINITY;for(var ur=Number.POSITIVE_INFINITY,cr=Number.NEGATIVE_INFINITY,dr=Number.POSITIVE_INFINITY,lr=Number.NEGATIVE_INFINITY,H=0;H<o;++H){var Kr=j[H],Xr=q[H],Sr=Kr/y,Nr=Xr/y,fr=h.lerp(S,N,sr[H]/y);I.longitude=h.lerp(v,M,Sr),I.latitude=h.lerp(s,E,Nr),I.height=fr,ur=Math.min(I.longitude,ur),cr=Math.max(I.longitude,cr),dr=Math.min(I.latitude,dr),lr=Math.max(I.latitude,lr);var Ar=d.cartographicToCartesian(I);c[H]=new gr(Sr,Nr),f[H]=fr,C[H]=Ar,e&&(Z[H]=($.geodeticLatitudeToMercatorAngle(I.latitude)-O)*W),x.multiplyByPoint(Y,Ar,Q),A.minimumByComponent(Q,_,_),A.maximumByComponent(Q,P,P)}var Ir=vr(r.westIndices,function(B,D){return c[B].y-c[D].y}),mr=vr(r.eastIndices,function(B,D){return c[D].y-c[B].y}),hr=vr(r.southIndices,function(B,D){return c[D].x-c[B].x}),Tr=vr(r.northIndices,function(B,D){return c[B].x-c[D].x}),xr,br;br=kr.fromPoints(C),xr=yr.fromRectangle(i,S,N,d);var Zr=yr.fromRectangle(i,w,K,d),Mr;if(l!==1||S<=0){var Jr=new Cr(d);Mr=Jr.computeHorizonCullingPointPossiblyUnderEllipsoid(p,C,S)}var k=S;k=Math.min(k,nr(r.westIndices,r.westSkirtHeight,f,c,i,d,Y,_,P)),k=Math.min(k,nr(r.southIndices,r.southSkirtHeight,f,c,i,d,Y,_,P)),k=Math.min(k,nr(r.eastIndices,r.eastSkirtHeight,f,c,i,d,Y,_,P)),k=Math.min(k,nr(r.northIndices,r.northSkirtHeight,f,c,i,d,Y,_,P));for(var $r=new Yr(_,P,p),L=new Lr($r,k,N,F,X,e),R=L.getStride(),jr=o*R+u*R,U=new Float32Array(jr),pr=0,V=0;V<o;++V){if(X){var Or=V*2;if(b.x=n[Or],b.y=n[Or+1],l!==1){var G=J.octDecode(b.x,b.y,Dr),wr=tr.eastNorthUpToFixedFrame(C[V],d,Qr),rt=x.inverseTransformation(wr,qr);x.multiplyByPointAsVector(rt,G,G),G.z*=l,A.normalize(G,G),x.multiplyByPointAsVector(wr,G,G),A.normalize(G,G),J.octEncode(G,b)}}pr=L.encode(U,pr,C[V],c[V],f[V],b,Z[V])}var tt=Math.max(0,(u-4)*2),at=r.indices.length+tt*3,rr=ar.createTypedArray(o+u,at);rr.set(r.indices,0);var Fr=1e-4,Wr=(cr-ur)*Fr,_r=(lr-dr)*Fr,ot=-Wr,et=0,nt=Wr,it=0,vt=0,st=_r,ut=0,ct=-_r,z=o*R;ir(U,z,Ir,L,f,c,n,d,i,r.westSkirtHeight,l,O,W,ot,et),z+=r.westIndices.length*R,ir(U,z,hr,L,f,c,n,d,i,r.southSkirtHeight,l,O,W,ut,ct),z+=r.southIndices.length*R,ir(U,z,mr,L,f,c,n,d,i,r.eastSkirtHeight,l,O,W,nt,it),z+=r.eastIndices.length*R,ir(U,z,Tr,L,f,c,n,d,i,r.northSkirtHeight,l,O,W,vt,st);var dt=ht(r.indices,j,q,r.level);return Br.addSkirtIndices(Ir,hr,mr,Tr,o,rr,r.indices.length,dt),a.push(U.buffer,rr.buffer),{vertices:U.buffer,indices:rr.buffer,westIndicesSouthToNorth:Ir,southIndicesEastToWest:hr,eastIndicesNorthToSouth:mr,northIndicesWestToEast:Tr,vertexStride:R,center:p,minimumHeight:S,maximumHeight:N,boundingSphere:br,orientedBoundingBox:xr,validOrientedBoundingBox:Zr,occludeePointInScaledSpace:Mr,encoding:L,indexCountWithoutSkirts:r.indices.length}}function ht(r,a,t,o){if(!(o<12)){for(var n={},u=r.length,e=0;e<u;e+=3){var i=r[e],v=r[e+1],s=r[e+2];(a[i]===y&&a[v]===y||a[i]===0&&a[v]===0||t[i]===y&&t[v]===y||t[i]===0&&t[v]===0)&&(n[i+"_"+v]=1,n[v+"_"+i]=1),(a[v]===y&&a[s]===y||a[v]===0&&a[s]===0||t[v]===y&&t[s]===y||t[v]===0&&t[s]===0)&&(n[v+"_"+s]=1,n[s+"_"+v]=1),(a[s]===y&&a[i]===y||a[s]===0&&a[i]===0||t[s]===y&&t[i]===y||t[s]===0&&t[i]===0)&&(n[s+"_"+i]=1,n[i+"_"+s]=1)}return n}}function nr(r,a,t,o,n,u,e,i,v){var s=Number.POSITIVE_INFINITY,M=n.north,E=n.south,d=n.east,l=n.west;d<l&&(d+=h.TWO_PI);for(var S=r.length,N=0;N<S;++N){var w=r[N],K=t[w],p=o[w];I.longitude=h.lerp(l,d,p.x),I.latitude=h.lerp(E,M,p.y),I.height=K-a;var F=u.cartographicToCartesian(I,Q);x.multiplyByPoint(e,F,F),A.minimumByComponent(F,i,i),A.maximumByComponent(F,v,v),s=Math.min(s,I.height)}return s}function ir(r,a,t,o,n,u,e,i,v,s,M,E,d,l,S){var N=T(e),w=v.north,K=v.south,p=v.east,F=v.west;p<F&&(p+=h.TWO_PI);for(var Y=t.length,O=0;O<Y;++O){var W=t[O],j=n[W],q=u[W];I.longitude=h.lerp(F,p,q.x)+l,I.latitude=h.lerp(K,w,q.y)+S,I.height=j-s;var sr=i.cartographicToCartesian(I,Q);if(N){var X=W*2;if(b.x=e[X],b.y=e[X+1],M!==1){var c=J.octDecode(b.x,b.y,Dr),f=tr.eastNorthUpToFixedFrame(Q,i,Qr),C=x.inverseTransformation(f,qr);x.multiplyByPointAsVector(C,c,c),c.z*=M,A.normalize(c,c),x.multiplyByPointAsVector(f,c,c),A.normalize(c,c),J.octEncode(c,b)}}var Z;o.hasWebMercatorT&&(Z=($.geodeticLatitudeToMercatorAngle(I.latitude)-E)*d),a=o.encode(r,a,sr,q,I.height,b,Z)}}function vr(r,a){var t;return typeof r.slice=="function"&&(t=r.slice(),typeof t.sort!="function"&&(t=void 0)),T(t)||(t=Array.prototype.slice.call(r)),t.sort(a),t}var Lt=Vr(mt);export{Lt as default};
