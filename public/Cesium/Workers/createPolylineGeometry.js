import{a as N}from"./chunk-QK4WXGAD.js";import"./chunk-XJVZABJP.js";import{a as s}from"./chunk-IMPZ7UGB.js";import{a as L}from"./chunk-SP6GVFX5.js";import{a as Ee}from"./chunk-W3WRSDQH.js";import"./chunk-VETUMSV6.js";import"./chunk-OGTTQ4KL.js";import"./chunk-7AR5UXG3.js";import{a as T}from"./chunk-W2I2FV32.js";import{a as Ae}from"./chunk-XKBSMKNP.js";import{a as Pe}from"./chunk-J4ID4JKR.js";import{d as de,e as me,g as ue,j as _e,n as we,o as M}from"./chunk-K2IDXOCV.js";import"./chunk-NPAFDOYL.js";import"./chunk-45OWWDV7.js";import{a as x}from"./chunk-JX5O4HI2.js";import"./chunk-6S43R6PL.js";import"./chunk-TW5GUTQO.js";import"./chunk-ZRLECQ27.js";import"./chunk-FEOWMVRK.js";import{a as w}from"./chunk-CUQT2UK5.js";import"./chunk-CB3KB2D3.js";import{a as f}from"./chunk-I46SWINN.js";import{a as $}from"./chunk-LNIYJJXS.js";import{a as _}from"./chunk-4D2ERGZX.js";import"./chunk-EDZQSM3T.js";import{a as S}from"./chunk-PJGSCWXZ.js";import{a as h}from"./chunk-NUC3LT2W.js";import"./chunk-SFC4FDPW.js";var Le=[];function Ne(e,t,r,o,i){var v=Le;v.length=i;var p,O=r.red,D=r.green,E=r.blue,b=r.alpha,l=o.red,a=o.green,A=o.blue,n=o.alpha;if(s.equals(r,o)){for(p=0;p<i;p++)v[p]=s.clone(r);return v}var c=(l-O)/i,g=(a-D)/i,C=(A-E)/i,U=(n-b)/i;for(p=0;p<i;p++)v[p]=new s(O+p*c,D+p*g,E+p*C,b+p*U);return v}function R(e){e=_(e,_.EMPTY_OBJECT);var t=e.positions,r=e.colors,o=_(e.width,1),i=_(e.hMax,-1),v=_(e.colorsPerVertex,!1);if(!h(t)||t.length<2)throw new S("At least two positions are required.");if(typeof o!="number")throw new S("width must be a number");if(h(r)&&(v&&r.length<t.length||!v&&r.length<t.length-1))throw new S("colors has an invalid length.");this._positions=t,this._colors=r,this._width=o,this._hMax=i,this._colorsPerVertex=v,this._dist=e.dist,this._period=e.period,this._vertexFormat=T.clone(_(e.vertexFormat,T.DEFAULT)),this._followSurface=_(e.followSurface,!0),h(e.followSurface)&&(_e("PolylineGeometry.followSurface","PolylineGeometry.followSurface is deprecated and will be removed in Cesium 1.55. Use PolylineGeometry.arcType instead."),e.arcType=e.followSurface?L.GEODESIC:L.NONE),this._arcType=_(e.arcType,L.GEODESIC),this._followSurface=this._arcType!==L.NONE,this._granularity=_(e.granularity,$.RADIANS_PER_DEGREE),this._ellipsoid=w.clone(_(e.ellipsoid,w.WGS84)),this._workerName="createPolylineGeometry";var p=1+t.length*f.packedLength;p+=h(r)?1+r.length*s.packedLength:1,this.packedLength=p+w.packedLength+T.packedLength+4+2}R.pack=function(e,t,r){if(!h(e))throw new S("value is required");if(!h(t))throw new S("array is required");r=_(r,0);var o,i=e._positions,v=i.length;for(t[r++]=v,o=0;o<v;++o,r+=f.packedLength)f.pack(i[o],t,r);var p=e._colors;for(v=h(p)?p.length:0,t[r++]=v,o=0;o<v;++o,r+=s.packedLength)s.pack(p[o],t,r);return w.pack(e._ellipsoid,t,r),r+=w.packedLength,T.pack(e._vertexFormat,t,r),r+=T.packedLength,t[r++]=e._width,t[r++]=e._colorsPerVertex?1:0,t[r++]=e._arcType,t[r++]=e._granularity,t[r++]=e._hMax,t[r++]=e._dist,t[r]=e._period,t};var be=w.clone(w.UNIT_SPHERE),ge=new T,k={positions:void 0,colors:void 0,ellipsoid:be,vertexFormat:ge,width:void 0,colorsPerVertex:void 0,arcType:void 0,granularity:void 0};R.unpack=function(e,t,r){if(!h(e))throw new S("array is required");t=_(t,0);var o,i=e[t++],v=new Array(i);for(o=0;o<i;++o,t+=f.packedLength)v[o]=f.unpack(e,t);i=e[t++];var p=i>0?new Array(i):void 0;for(o=0;o<i;++o,t+=s.packedLength)p[o]=s.unpack(e,t);var O=w.unpack(e,t,be);t+=w.packedLength;var D=T.unpack(e,t,ge);t+=T.packedLength;var E=e[t++],b=e[t++]===1,l=e[t++],a=e[t++],A=e[t++],n=e[t++]==1,c=e[t];return h(r)?(r._positions=v,r._colors=p,r._ellipsoid=w.clone(O,r._ellipsoid),r._vertexFormat=T.clone(D,r._vertexFormat),r._width=E,r._colorsPerVertex=b,r._arcType=l,r._granularity=a,r._hMax=A,r._dist=n,r._period=c,r):(k.positions=v,k.colors=p,k.width=E,k.colorsPerVertex=b,k.arcType=l,k.granularity=a,k.hMax=A,k.dist=n,k.period=c,new R(k))};var Te=new f,ke=new f,De=new f,ye=new f;R.createGeometry=function(e){var t=e._width,r=e._hMax,o=e._vertexFormat,i=e._colors,v=e._colorsPerVertex,p=e._arcType,O=e._granularity,D=e._ellipsoid,E=e._dist,b=e._period,l,a,A,n=Ee(e._positions,f.equalsEpsilon),c=n.length;if(c<2||t<=0)return;if(p===L.GEODESIC||p===L.RHUMB){var g,C;p===L.GEODESIC?(g=$.chordLength(O,D.maximumRadius),C=N.numberOfPoints):(g=O,C=N.numberOfPointsRhumbLine);var U=N.extractHeights(n,D);if(h(i)){var J=1;for(l=0;l<c-1;++l)J+=C(n[l],n[l+1],g);var G=new Array(J),K=0;for(l=0;l<c-1;++l){var I=n[l],ee=n[l+1],re=i[l],te=C(I,ee,g);if(v&&l<J){var Fe=i[l+1],ae=Ne(I,ee,re,Fe,te),Ve=ae.length;for(a=0;a<Ve;++a)G[K++]=ae[a]}else for(a=0;a<te;++a)G[K++]=s.clone(re)}G[K]=s.clone(i[i.length-1]),i=G,Le.length=0}p===L.GEODESIC?n=N.generateCartesianArc({positions:n,minDistance:g,ellipsoid:D,height:U,hMax:r}):n=N.generateCartesianRhumbArc({positions:n,granularity:g,ellipsoid:D,height:U})}c=n.length;var y=c*4-4,oe=new Float64Array(y*3),ie=new Float64Array(y*3),pe=new Float64Array(y*3),B=new Float32Array(y*2),Q=o.st?new Float32Array(y*2):void 0,F=h(i)?new Uint8Array(y*4):void 0,q=E?new Float32Array(y*3):void 0,W=0,H=0,ne=0,Y=0,ce=0,d,X=0;for(a=0;a<c;++a){a===0?(d=Te,f.subtract(n[0],n[1],d),f.add(n[0],d,d)):d=n[a-1],f.clone(d,De),f.clone(n[a],ke),a===c-1?(d=Te,f.subtract(n[c-1],n[c-2],d),f.add(n[c-1],d,d)):d=n[a+1],f.clone(d,ye);var Z,ve;h(F)&&(a!==0&&!v?Z=i[a-1]:Z=i[a],a!==c-1&&(ve=i[a]));var xe=a===0?2:0,Me=a===c-1?2:4;for(A=xe;A<Me;++A){f.pack(ke,oe,W),f.pack(De,ie,W),f.pack(ye,pe,W),W+=3;var Oe=A-2<0?-1:1,fe=2*(A%2)-1,Se=fe*a/c;if(r>0?B[H++]=Se:B[H++]=fe,B[H++]=Oe*t,o.st&&(Q[ne++]=a/(c-1),Q[ne++]=Math.max(B[H-2],0)),h(F)){var j=A<2?Z:ve;F[Y++]=s.floatToByte(j.red),F[Y++]=s.floatToByte(j.green),F[Y++]=s.floatToByte(j.blue),F[Y++]=s.floatToByte(j.alpha)}E&&(q[ce*3]=X,ce++)}X+=f.distance(d,n[a])}if(E){var le=X,Ce=Math.random()*(b>0?b:le);for(a=0;a<y;a++)q[a*3+1]=le,q[a*3+2]=Ce}var V=new Pe;V.position=new M({componentDatatype:x.DOUBLE,componentsPerAttribute:3,values:oe}),V.prevPosition=new M({componentDatatype:x.DOUBLE,componentsPerAttribute:3,values:ie}),V.nextPosition=new M({componentDatatype:x.DOUBLE,componentsPerAttribute:3,values:pe}),V.expandAndWidth=new M({componentDatatype:x.FLOAT,componentsPerAttribute:2,values:B}),o.st&&(V.st=new M({componentDatatype:x.FLOAT,componentsPerAttribute:2,values:Q})),h(F)&&(V.color=new M({componentDatatype:x.UNSIGNED_BYTE,componentsPerAttribute:4,values:F,normalize:!0})),E&&(V.dist=new M({componentDatatype:x.FLOAT,componentsPerAttribute:3,values:q}));let he=c*6-6;c>2&&(he+=(c-2)*6);var m=Ae.createTypedArray(y,he),u=0,P=0,se=c-1;for(a=0;a<se;++a)m[P++]=u,m[P++]=u+2,m[P++]=u+1,m[P++]=u+1,m[P++]=u+2,m[P++]=u+3,c>2&&a!==se-1&&(m[P++]=u+3,m[P++]=u+5,m[P++]=u+4,m[P++]=u+2,m[P++]=u+5,m[P++]=u+4),u+=4;return new we({attributes:V,indices:m,primitiveType:ue.TRIANGLES,boundingSphere:de.fromPoints(n),geometryType:me.POLYLINES})};var z=R;function Be(e,t){return h(t)&&(e=z.unpack(e,t)),e._ellipsoid=w.clone(e._ellipsoid),z.createGeometry(e)}var cr=Be;export{cr as default};
